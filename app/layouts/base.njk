{% extends "govuk/template.njk" %}

{% set htmlClasses = "no-js" %}
{% set pageNumber = pagination.pageNumber + 1 %}
{% set pageCount = pagination.pages | length %}

{% from "govuk/components/breadcrumbs/macro.njk" import govukBreadcrumbs %}

{% from "x-govuk/components/masthead/macro.njk" import xGovukMasthead %}
{% from "x-govuk/components/related-navigation/macro.njk" import xGovukRelatedNavigation %}
{% from "x-govuk/components/side-navigation/macro.njk" import xGovukSideNavigation %}

{% from "app/components/article/macro.njk" import appArticle %}
{% from "app/components/document-list/macro.njk" import appDocumentList %}
{% from "app/components/header/macro.njk" import appHeader %}
{% from "app/components/pagination/macro.njk" import appPagination %}

{% block head %}
  <link rel="stylesheet" href="{{ '/assets/govuk.css' | url }}">
  {% block styles %}{% endblock %}

  <meta property="og:title" content="{{ title }}">
  {% if description %}<meta property="og:description" name="description" content="{{ description | markdown("inline") | striptags(true) }}">{% endif %}
{% endblock %}

{% block pageTitle %}
  {{- title if title -}}
  {{- " (page " + pageNumber + " of " + pageCount + ")" if pageCount > 1 -}}
  {{- " - " + (config.serviceName or config.productName) if config.serviceName or config.productName -}}
  {{- " - " + config.organisationName -}}
{% endblock %}

{% block header %}
  {{ appHeader({
    logotypeImage: config.organisationLogo,
    logotypeText: config.organisationName,
    homepageUrl: config.homepageUrl | url,
    productName: config.productName,
    serviceName: config.serviceName if not config.productName,
    serviceUrl: (config.serviceUrl | url) if not config.productName,
    searchIndex: config.searchIndex
  }) }}
{% endblock %}

{% block bodyEnd %}
  <script src="{{ '/assets/govuk.js' | url }}"></script>
  <script>
    document.documentElement.classList.remove('no-js')
    const searchContainer = document.querySelector('[data-module="app-search"]')
    new GOVUK11ty.SiteSearch(searchContainer).init()
  </script>
  {% block scripts %}{% endblock %}
{% endblock %}
